import { Scene } from '../../story-manager';

// The Crystal Heart - Ancient Power Shattered

const crystalHeartLegend = `The Crystal Heart. Even speaking its name carries weight, invokes memories of power that once protected an entire kingdom. For generations, it stood as the centerpiece of Silverwood's might - a massive gemstone pulsing with concentrated magical energy, radiating protective wards that kept Shadow Beasts at bay, stabilized the realm's magical balance, and amplified the royal bloodline's inherent gifts. Historians called it the kingdom's soul. Poets named it the heart that never stopped beating. Your ancestors simply knew it as salvation.`;

const theShatteringMoment = `But during the Purge, when coup forces stormed the palace and blood magic wards failed one by one under overwhelming assault, the last defenders made desperate choice. Rather than let the Crystal Heart fall into hands that would corrupt its power, they shattered it. Better to scatter hope across the realm than gift tyranny with ultimate weapon. The explosion of released magic was catastrophic - witnesses said the sky itself cracked, reality wavered, and for three days afterward no magic functioned properly within a hundred miles of the capital.`;

const fragmentsScattered = `Five fragments survived the shattering, each carrying portion of the whole's power, each finding new home across the realm. Some were deliberately hidden by surviving loyalists. Others were drawn to places of natural magic, bonding with guardians who recognized their significance. Over twenty years, the fragments became legend - objects of myth, goals for treasure hunters, sources of speculation among scholars who debated whether reunification was even possible.`;

const yourMission = `But you know the truth Lyra taught you: the fragments remember being whole. Royal blood can call them home. And the realm desperately needs what the Crystal Heart provided - protection from the Shadow Beasts growing bolder each season, magical stability as old wards continue failing, hope that restoration is possible rather than just political fantasy.`;

const crystalTruth = `${crystalHeartLegend}

${theShatteringMoment}

${fragmentsScattered}

${yourMission}

Whatever political path you've chosen - Loyalist restoration, Reformist democracy, Military pragmatism, or fierce Independence - this truth remains absolute and non-negotiable: the Crystal Heart must be restored. The kingdom's survival depends on it. Your legitimacy as heir requires it. And perhaps most importantly, the people suffering under increasing Shadow Beast attacks need it.`;

const warRoomSetting = `Marcus has transformed a secure chamber in your headquarters into military war room. Maps cover every wall, marked with intelligence reports, troop positions, political boundaries, and most significantly, five glowing points indicating where magical scrying has located the Crystal Heart fragments. Candles illuminate the space with golden light, casting shadows that make the maps seem alive, breathing with strategic possibility.`;

const marcusIntelligence = `Marcus stands at the central table, commander in his element, organizing complexity into actionable strategy. He's gathered intelligence from every reliable source - military scouts, merchant networks, Lyra's elven contacts, diplomatic channels, even carefully vetted Shadow Cult defectors who've provided information in exchange for protection. His presentation is thorough, professional, and sobering in its implications.

"The fragments are located as follows," he begins, tapping each marked position:

"Moonwhisper Grove - held by the high elves in their ancient forest sanctuary. Lyra's people have protected it for two decades, treating it as sacred trust. They won't simply surrender it to political claims. You'll need to prove yourself worthy through their cultural trials and earn their respect genuinely, not just demand allegiance based on bloodline."

His finger moves to the mountains. "Ironpeak Mountains - claimed by the dwarven clans deep in their fortress-city. The dwarves view it as payment for centuries of trade agreements the old monarchy never properly honored. They're not hostile, but they are pragmatic. They'll negotiate, but expect substantial concessions or proof that your rule will be different from previous generations that exploited their craftsmanship."

The northern peaks receive his attention next. "Dragon's Spine - guarded by Thorne Drake's flight in the volcanic highlands. Dragons respect only strength and wisdom proven through direct challenge. They've established trials specifically to test anyone who seeks the fragment. Failure means death. Success means earning the most powerful allies in the realm."

His expression darkens for the next location. "The Obsidian Wastes - corrupted by Shadow magic after falling into the hands of the Shadow Cult. This fragment has been twisted, its protective nature inverted into something dangerous. Reclaiming it won't just require defeating cultists - you'll need to purify the fragment itself, risking corruption in the process."

Finally, he indicates the capital. "Beneath the royal palace - hidden in the deepest vaults by your family before the Purge. Magically sealed so only Silverwood blood can access it. But the palace is politically contested territory. Every faction has staked claims. Attempting to retrieve it could trigger immediate political crisis, civil conflict, or worse. Yet it's also the most powerful fragment, the core piece that all others connect to."`;

const intelligenceSummary = `${warRoomSetting}

${marcusIntelligence}

Marcus steps back, letting the information sink in. "Each location presents unique challenges. Each fragment will require different approach. And each choice you make will send messages to various political forces about your priorities and methods."`;

const lyrasPerspective = `Lyra moves forward, ancient eyes reflecting candlelight as she studies the marked locations with intimate knowledge spanning centuries. When she speaks, her voice carries the weight of someone who's lived through the original Crystal Heart's power, witnessed its shattering, and spent decades contemplating what reunification might mean.

"Each fragment has bonded with its guardian or location," she explains, fingers tracing invisible patterns in the air above the map. "They've absorbed the nature of where they've rested, taken on characteristics of those who've protected them. The elven fragment pulses with forest magic now - it won't respond to commands or political authority. It must be persuaded, honored, approached with genuine respect for the natural world."

She gestures toward the mountains. "The dwarven fragment has grown dense, solid, patient as stone. Dwarven magic has reinforced it, made it nearly indestructible but also deeply rooted in their culture of reciprocity and fair exchange. They won't be simply given it up. You must prove through action and sacrifice that you understand the weight of what you're asking."

Her expression grows troubled at the volcanic peaks. "The dragon fragment burns with ancient pride and primal power. Dragons are neither cruel nor kind - they simply are. Thorne Drake's trials will test whether you possess not just strength but the wisdom to wield it properly. Many have attempted. Most are dead. Those who survived but failed earned the dragons' eternal disdain."

Shadow crosses her face discussing the Wastes. "The corrupted fragment... that one I fear most. Shadow magic doesn't just taint - it inverts, perverts, transforms protection into harm. Whoever corrupted it poured malice and despair into something created to shield and nurture. Reclaiming it means confronting darkness that will try to corrupt you, whisper your deepest fears, exploit every doubt. You'll need extraordinary mental fortitude or powerful magical protection - preferably both."

Finally, she addresses the palace. "And the core fragment, sealed by your grandmother's own hand in the final moments before the Purge. She wove blood magic into that vault specifically so only true Silverwood heir could access it. But it's been sealed for twenty years, marinating in the echoes of betrayal, death, desperate sacrifice. Opening it will release more than just a magical artifact - it will release memories, trauma, the concentrated grief of your family's destruction. Be prepared for that emotional weight."

Lyra meets your eyes with fierce intensity. "None of these fragments will be simply taken. You must prove worthy - through trial, negotiation, sacrifice, wisdom, or sometimes all of these at once. And the order you choose to pursue them will shape the challenges you face. Early choices establish your reputation, create precedents, open or close diplomatic doors."`;

const lyraWarning = `${lyrasPerspective}`;

const companionReactions = `Your companions stand around the war room, each processing the information through their own perspectives and concerns. The weight of what you're attempting settles over them like physical burden - five fragments scattered across hostile or contested territory, each recovery a quest unto itself, the whole endeavor carrying stakes that could determine the kingdom's future.`;

const decisionWeight = `The choice before you is enormous. Five fragments, five different approaches required, five opportunities to succeed or fail. Your choice of which fragment to pursue first will determine much of what follows - establishing your methods, revealing your priorities, creating ripple effects through political landscape already tense with uncertainty and hope and fear.

Do you start with diplomacy among the elves, building alliance with magical races who've been marginalized by human politics? Do you prove yourself through dwarven pragmatism and cultural respect? Do you face the dragons' deadly trials to earn the realm's most powerful allies through sheer demonstrated worth? Do you confront the Shadow Cult and risk corruption to deny them a weapon they've already perverted? Or do you claim your family's legacy first, securing the core fragment despite political consequences?

Each path is valid. Each carries risks and rewards. And each will shape not just your quest for the Crystal Heart, but the kind of ruler you'll become in pursuing it.`;

const getCrystalHuntStartText = (): string => {
	return `${crystalTruth}

${intelligenceSummary}

${lyraWarning}

${companionReactions}

${decisionWeight}`;
};

// Crystal Hunt Beginning - Converging Point for All Paths
export const CrystalHuntStart: Scene = {
	id: 'crystal_hunt_start',
	get text() {
		return getCrystalHuntStartText();
	},
	textVariants: [
		{
			conditions: { hasFlags: ['loyalist_path_confirmed:true', 'seraphine_becomes_advisor:true'] },
			text: `${crystalTruth}

${intelligenceSummary}

Seraphine reviews Marcus's intelligence with the practiced efficiency of someone trained from birth in strategic thinking. She's in her element here - analyzing political implications, calculating advantages, planning approaches that leverage your Loyalist backing into diplomatic capital. Her finger traces routes on the map with confident precision.

"As Loyalist-backed heir with noble houses supporting your claim, we possess significant political advantage," she explains, her analytical mind already running multiple scenarios. "The elves and dwarves remember when Silverwood monarchs ruled with legitimacy and honor. They may be more willing to negotiate with someone who represents restoration of that legitimate order rather than revolutionary upheaval or military force."

Lady Ashford nods agreement from her position by the door. "The magical races respect tradition and proper succession. Your bloodline claim, reinforced by noble support, carries weight they understand and value. Use that."

But Seraphine's expression grows more complex. "However, the dragons will be... complicated. They respect only demonstrated strength and wisdom, not political backing or noble pedigree. To them, human factional alliances are irrelevant theater. You'll need to prove yourself through their trials on your own merits, not your supporters' reputations."

She meets your eyes with mixture of strategic calculation and personal concern. "I recommend starting with the palace fragment. Securing your ancestral home and the core piece sends powerful message to all factions - both your allies and opponents. It demonstrates you're serious about reclaiming your heritage, establishes you physically in the seat of royal power, and provides the strongest fragment as foundation for gathering the others."

${lyraWarning}

But Lyra interjects gently, "The palace fragment is politically explosive. Every faction has staked claims on that territory. Moving to retrieve it immediately could trigger the very conflicts we're trying to avoid."

Seraphine acknowledges the point with slight nod. "Risk and reward must be balanced. But sometimes bold moves create the political momentum needed to carry forward."

${companionReactions}

The strategic weight of your Loyalist alliance is clear - doors open more easily, negotiations start from positions of strength, traditional powers are more receptive. But that same alliance creates expectations, obligations, and the need to maintain consistency with principles of legitimate restoration rather than revolutionary change.

${decisionWeight}`
		},
		{
			conditions: { hasFlags: ['reformist_path_confirmed:true', 'sage_becomes_close_advisor:true'] },
			text: `${crystalTruth}

${intelligenceSummary}

Sage leans over the map with intense focus, but his analytical approach differs fundamentally from Marcus's military perspective. He's not calculating how to take the fragments - he's considering how to earn them, how to demonstrate that your democratic reforms represent genuine change rather than just rhetoric masquerading as revolution.

"The magical races have been marginalized by human politics for generations," he says thoughtfully, fingers tracing the locations with scholar's precision. "They've watched factions squabble over power while their concerns were dismissed as secondary, their voices excluded from decisions that affected their lives. They're deeply, justifiably skeptical of any human claiming to be different."

Dane adds his pragmatic worker's perspective. "Actions prove intentions. Words are cheap - everyone promises change until they have power. Then priorities shift."

Sage nods vigorously. "Exactly. Which is why I believe we should start with diplomatic missions to the elves and dwarves. Don't demand fragments based on bloodline or political backing. Ask to prove ourselves worthy. Show them through actions that your democratic reforms are real, that you genuinely intend to include magical races in governance, that sharing power isn't just campaign promise but foundational principle."

His idealistic fervor brightens his expression. "Imagine if we approached the elves not as supplicants demanding ancient artifacts, but as equals proposing genuine alliance? If we offered the dwarves not just payment for the fragment but seats in the new democratic council? We could build coalitions based on shared values rather than coerced cooperation."

${lyraWarning}

Lyra watches Sage with something approaching approval. "Your advisor understands what previous human leaders never grasped - respect cannot be demanded, only earned. And genuine respect requires genuine equality."

Sage meets your eyes with fierce conviction. "The Reformist path is harder precisely because we refuse to rely on traditional authority or military force. But that difficulty is also our strength. Prove the new system works before claiming ancient power. Show the realm that democracy can succeed through cooperation rather than domination."

${companionReactions}

The idealistic challenge is clear - your Reformist principles mean rejecting shortcuts that other paths might employ. But if you succeed in building genuine alliances based on equality and respect, you'll create something far more sustainable than forced cooperation or political manipulation.

${decisionWeight}`
		},
		{
			conditions: { hasFlags: ['military_path_confirmed:true', 'kieran_conflicted:true'] },
			text: `${crystalTruth}

${intelligenceSummary}

General Blackwood studies the map with tactician's ruthless efficiency, calculating force requirements, casualty projections, strategic advantages. His approach to the fragments is simple: identify targets, deploy overwhelming force, secure objectives. The moral complexity that troubles others seems absent from his calculations - there's only mission success or mission failure.

"We should take them by force if necessary," he states flatly, no hesitation in his conviction. "The kingdom needs those fragments now, not after months of lengthy negotiations or cultural sensitivity training. Every day we delay, Shadow Beasts grow bolder, more people die, the realm grows weaker. Diplomatic niceties are luxury we cannot afford."

He taps the Obsidian Wastes significantly. "Strike the Shadow Cult first. Deny them their corrupted weapon, demonstrate our military capability, establish that your rule will be decisive rather than weak. Then move on the other locations with momentum on our side. The elves and dwarves will negotiate more readily when they see we're willing to use force."

But Kieran shifts uncomfortably beside his uncle, conflict written across his features. The young captain has been growing increasingly troubled by the Military faction's approach, by methods that prioritize efficiency over ethics, strength over wisdom. His loyalty to you has evolved beyond simple faction duty into something more personal, more complicated.

"Uncle," Kieran interrupts carefully, voice carrying respect but also challenge, "the magical races are powerful allies or extremely dangerous enemies. Dragons alone could level our armies if properly motivated. Perhaps diplomacy first, force only as last resort?"

The tension between their approaches crackles like lightning. Blackwood's expression hardens. "Diplomacy from position of weakness is just begging. Diplomacy from position of demonstrated strength is negotiation."

Kieran doesn't back down. "There's a difference between being strong enough to protect versus strong enough to threaten. One creates allies. The other creates future enemies we'll fight forever."

${lyraWarning}

Lyra's ancient eyes settle on Kieran with approval, on Blackwood with warning. "The young captain speaks wisdom his general should heed. Force can secure fragments, yes. But it will also ensure that those who possess them become permanent adversaries. Is that the realm you wish to build? One held together by threat rather than trust?"

${companionReactions}

The Military path's advantages are clear - speed, efficiency, decisive action. But so are its dangers - alienating potential allies, creating resentment that will fester for generations, proving through violence that the new monarchy is no different from the old tyranny. Kieran's growing conflict with his uncle reflects larger questions about what kind of strength truly protects versus what kind merely dominates.

${decisionWeight}`
		},
		{
			conditions: { hasFlags: ['independent_path_confirmed:true', 'companions_most_important:true'] },
			text: `${crystalTruth}

${intelligenceSummary}

Rowan grins at the map with ranger's wild appreciation for complexity. Your independent path - refusing faction allegiance, building your own coalition based on personal relationships and earned trust rather than political obligation - has created unique situation. You lack the institutional backing other paths provide, but you've also avoided their baggage, their obligations, their reputations for exploitation or manipulation.

"No faction backing means the magical races might actually trust you," Rowan observes with satisfaction. "They're exhausted by human politics - the Loyalists who treated them as subjects to command, the Reformists who promised inclusion but delivered exclusion, the Military who saw them as resources or threats. But you? You walked away from all that. Built something new. They'll respect that independence."

Lyra nods with genuine approval rare from someone who's observed human politics for centuries. "My people in Moonwhisper Grove have been waiting for a human leader who seeks genuine alliance rather than political advantage. Someone who sees elves as partners, not tools. Your rejection of factional games opens doors the factions never could access."

She gestures toward the elven forest marked on the map. "Start with us. I can introduce you properly - not as Loyalist heir demanding ancient obligations, not as Reformist making empty promises, not as Military threatening consequences. Just as yourself. As someone who chose principle over expedience, companions over political backing, building something real over maintaining something broken."

${lyraWarning}

Rowan adds with characteristic bluntness, "The independent path is harder in some ways - no army backing you, no noble resources, no institutional support. But it's also freer. You can make genuine offers without factional agenda compromising them. Can build alliances based on who you actually are rather than who your supporters need you to be."

${companionReactions}

Your companions - Sage, Kieran, Rowan, Seraphine, Lyra, and others who chose you personally rather than politically - are your strength. They represent possibility of new kind of leadership, one based on earned loyalty rather than coerced obligation. The magical races who've been marginalized for generations can see that difference. Your independent path, built on genuine relationships and personal integrity, might achieve what institutional power never could.

${decisionWeight}`
		},
		{
			conditions: { hasHiddenAttributes: { loyalist_path_confirmed: true } },
			text: `${crystalTruth}

${intelligenceSummary}

Seraphine reviews the intelligence with strategic precision. "As Loyalist-backed heir with noble support, we have political advantage. The elves and dwarves may negotiate more readily, recognizing legitimate succession. But the dragons respect only demonstrated strength and wisdom, regardless of political backing."

Lady Ashford adds, "I suggest starting with the palace fragment - securing your ancestral home sends powerful message to all factions about your commitment to restoration."

${lyraWarning}

${companionReactions}

${decisionWeight}`
		},
		{
			conditions: { hasHiddenAttributes: { reformist_path_confirmed: true } },
			text: `${crystalTruth}

${intelligenceSummary}

Sage suggests thoughtfully, "The magical races are deeply skeptical of monarchies, even reformed ones. But they might respect a ruler who genuinely shares power with the people rather than just claiming to. Let's start with diplomatic missions - show them through actions that we're different from previous regimes."

Dane agrees with pragmatic nod. "Prove the new democratic system works before claiming ancient power. Actions matter more than promises."

${lyraWarning}

${companionReactions}

${decisionWeight}`
		},
		{
			conditions: { hasHiddenAttributes: { independent_path_confirmed: true } },
			text: `${crystalTruth}

${intelligenceSummary}

Rowan grins with satisfaction. "No faction backing means the magical races might actually trust you. They're tired of human politics and factional manipulation. Your independence could be your greatest advantage."

Lyra nods approvingly. "Start with my people in Moonwhisper Grove. I can introduce you properly. An independent heir seeking genuine alliance rather than political advantage? That they'll respect in ways they never respected factional leaders."

${lyraWarning}

${companionReactions}

Your independent path has opened doors the factions couldn't access, but it also means facing challenges without institutional support.

${decisionWeight}`
		}
	],
	choices: [
		{
			id: 'prepare-first',
			text: 'Prepare thoroughly before starting the quest - visit merchants and gather intelligence, supplies, and magical equipment',
			next: 'crystal_quest_merchant',
			effects: { wisdom: 3 },
			hiddenEffects: {
				thorough_preparation: true,
				merchant_consultation: true
			}
		},
		{
			id: 'elven',
			text: 'Seek the Moonwhisper Grove fragment first - approach the elves with respect and willingness to prove yourself through their cultural trials',
			next: 'elven_fragment_quest',
			effects: { wisdom: 3 },
			hiddenEffects: {
				'first_fragment_choice:elven': true,
				lyra_respect: 10,
				diplomatic_approach: true
			}
		},
		{
			id: 'dwarven',
			text: 'Journey to Ironpeak Mountains for the dwarven fragment - engage in pragmatic negotiation and demonstrate cultural respect',
			next: 'dwarven_fragment_quest',
			effects: { courage: 3 },
			hiddenEffects: {
				'first_fragment_choice:dwarven': true,
				pragmatic_approach: true
			}
		},
		{
			id: 'dragon',
			text: 'Challenge the Dragon Spine fragment trials - prove yourself to the dragons through tests of strength, wisdom, and character',
			next: 'dragon_fragment_quest',
			effects: { courage: 5 },
			hiddenEffects: {
				'first_fragment_choice:dragon': true,
				bold_approach: true,
				thorne_respect: 10
			}
		},
		{
			id: 'palace',
			text: 'Secure the palace fragment first - claim your ancestral home and the core piece despite political complications',
			next: 'palace_fragment_quest',
			effects: { wisdom: 2, courage: 2 },
			hiddenEffects: {
				'first_fragment_choice:palace': true,
				political_approach: true,
				loyalist_rep: 10
			}
		},
		{
			id: 'prepare-training',
			text: 'Undergo intensive combat training with Kieran first - prepare yourself physically and mentally for the dangerous trials ahead',
			next: 'warrior_drills_training',
			effects: { wisdom: 2 },
			hiddenEffects: {
				preparation_focused: true,
				strategic_thinking: true
			}
		}
	]
};

// Elven Fragment Quest - Moonwhisper Grove

const moonwhisperApproach = `The journey to Moonwhisper Grove takes you deep into ancient forest that predates human civilization by millennia. Trees tower overhead like cathedral pillars, their trunks wider than houses, their canopy so thick that sunlight filters through in golden shafts that seem almost solid. The air itself feels different here - cleaner, charged with natural magic that makes your blood mark tingle in recognition of power that exists outside human understanding.`;

const forestMagic = `Everything in this forest is alive in ways that transcend simple botany. Trees whisper to each other through root networks that span miles. Flowers turn to track your passage with something approaching curiosity. Even the wind seems purposeful, carrying scents and sounds with deliberate intention. This is the heart of elven territory, a place where nature and magic are indistinguishable, where the boundary between physical and mystical blurs into irrelevance.`;

const elvenWelcome = `Lyra leads you forward, and the forest responds to her presence like greeting beloved child. Branches part to create clear path. Flowers bloom in her footsteps. Birds call melodious welcome that sounds almost like language. She's home here in ways that humans can never truly be - this forest is her birthplace, her sanctuary, her living heritage spanning centuries.

The elven settlement appears gradually, so naturally integrated with the forest that at first you don't recognize you're walking through inhabited space. Platforms suspended high in the trees, connected by rope bridges and living wood that grew into walkways over decades of careful cultivation. Buildings that aren't separate from trees but extensions of them - rooms carved within massive trunks, doorways that are simply openings in bark, windows that frame forest views with artistic precision.`;

const elvenCouncil = `The elven council awaits in a natural amphitheater where ancient trees form perfect circle, their branches interweaving overhead to create domed ceiling. Sunlight streams through gaps in deliberate patterns, illuminating a central platform made from single massive stone that probably predates the forest itself. Dozens of elves gather - some young by elven standards at mere century or two, others ancient beyond human comprehension, faces carrying the weight of millennia lived with full memory intact.`;

const councilGreeting = `The council leader steps forward - an elf whose age shows in eyes that have witnessed the rise and fall of civilizations, whose silver hair cascades like waterfall to their waist, whose bearing combines grace with authority that comes from living long enough to understand true patience. They study you with curiosity mixed with caution.

"So," they say, voice carrying the musical quality of elvish speech, "the lost heir of Silverwood comes seeking what we've protected for twenty years. Lyra speaks well of you, and her word carries weight among our people. But words and deeds are different things. We have watched human kingdoms rise with noble intentions and fall into corruption. We have witnessed promises made and broken, alliances formed and betrayed. Why should we trust that you represent something different?"`;

const trialAnnouncement = `Another council member speaks, younger but no less serious. "The Crystal Heart fragment has bonded with our forest, become part of our living magic. It protects our trees, nurtures our land, connects with the natural power we've cultivated for generations. You ask us to give up something that has become precious to us, that serves purposes beyond your political restoration."

The elder nods. "But we understand the fragment is incomplete without its siblings, that the Crystal Heart's true purpose was protecting the entire realm, not just our forest. If you can prove yourself worthy - through trial, through demonstration of wisdom and respect for the natural world, through earning rather than demanding - we will consider alliance."

They gesture to encompass the forest. "Three trials await you. Trial of Understanding - prove you comprehend what you're asking and what it costs. Trial of Respect - demonstrate genuine regard for ways of life different from your own. Trial of Sacrifice - show you're willing to give as well as take. Succeed, and we will not just surrender the fragment but become true allies. Fail, and you leave empty-handed but hopefully wiser."`;

const getElvenFragmentQuestText = (): string => {
	return `${moonwhisperApproach}

${forestMagic}

${elvenWelcome}

${elvenCouncil}

${councilGreeting}

${trialAnnouncement}

Lyra watches you carefully, pride and concern mixing in her ancient eyes. These are her people. Their judgment of you matters to her in ways that go beyond simple quest objectives. This is about whether you can truly bridge the divide between human and elven understanding, whether your claims of being different from previous rulers are genuine or just expedient rhetoric.`;
};

// Placeholder scenes for fragment quests
export const ElvenFragmentQuest: Scene = {
	id: 'elven_fragment_quest',
	get text() {
		return getElvenFragmentQuestText();
	},
	choices: [
		{
			id: 'continue',
			text: 'Accept the elven trials with humility and genuine respect - prove yourself worthy through their cultural tests',
			next: 'companion_personal_quests',
			effects: { wisdom: 5 },
			hiddenEffects: {
				elven_fragment_obtained: true,
				lyra_respect: 25
			}
		}
	]
};

// Dwarven Fragment Quest - Ironpeak Mountains

const ironpeakJourney = `The journey to Ironpeak Mountains tests endurance in ways the elven forest didn't. The path climbs steadily upward through terrain that grows increasingly harsh - rocky slopes that require careful navigation, thin air that makes breathing labored, cold that seeps through even the warmest clothing. But the views are spectacular: jagged peaks piercing clouds, valleys stretching toward distant horizons, the raw beauty of mountains that have stood unchanged since the world was young.`;

const finnLeading = `Finn leads the way with obvious pride and joy, his boulder-built frame perfectly suited to mountain terrain that leaves humans struggling. He points out landmarks with infectious enthusiasm - the cliff face where his grandfather carved the first dwarven declarations, the pass where legendary battles were fought centuries ago, the peaks that mark clan boundaries invisible to human eyes but clear as roads to dwarves who've lived here for generations.

"Welcome to real civilization," he announces with theatrical flourish as the first dwarven structures become visible. "Built to last centuries, not decades. Carved from living stone, not stacked from fragile wood. This is what permanence looks like."`;

const ironpeakCity = `The dwarven fortress-city of Ironpeak is architectural marvel that defies human understanding. Carved directly into the mountain over generations of patient labor, it's part natural cave system expanded and refined, part deliberate construction that demonstrates mastery of stone and engineering. Massive gates stand open - thick iron bound with runes, mounted on hinges that should be impossible to move but swing with perfect balance. Beyond, corridors stretch into mountain depths, lit by crystal lamps that glow with soft magical light, decorated with intricate carvings depicting dwarven history in loving detail.

The city isn't cramped or dark as surface-dwellers might imagine. Vast chambers open like cathedrals, their ceilings supported by columns carved from living rock, their walls covered with artistic reliefs and precious metal inlays. The air circulation is perfect - no stuffiness, no smoke, just clean mountain air drawn through cunningly designed ventilation shafts. The temperature remains comfortable regardless of external weather. Everything speaks of engineering mastery accumulated over millennia.`;

const dwarvenWelcome = `The dwarven delegation meets you in a formal hall whose grandeur rivals any human palace. The walls display their finest craftsmanship - armor that's functional art, weapons that are lethal poetry, jewelry that captures light and transforms it into something approaching magic. A massive table dominates the center, already laden with food in preparation for traditional welcome feast.

But Seraphine catches your attention before formal introductions begin, pulling you aside with urgent whisper. "The dwarves value hospitality above almost all else," she explains quietly, drawing on her noble education about other cultures. "Food is sacred to them - how they show respect and build trust, how they measure sincerity of visitors. The delegation we're meeting will be assessing our intentions partly through how we approach this meal."

She gestures toward the laden table. "We have two options. We could prepare a diplomatic feast as our contribution - show them we understand their culture enough to honor it properly, that we care enough to make effort. It would require time, resources, coordination with their kitchen staff. But it would demonstrate respect in language they understand fundamentally."

Her expression grows more serious. "Or we can rely on traditional formal political negotiations. Accept their hospitality, conduct standard diplomatic protocol, make our case through logical argument and political calculation. More efficient, certainly. But potentially missing opportunity to connect on deeper cultural level."

Finn adds his perspective with uncharacteristic seriousness. "My people respect those who understand that sharing meals means sharing trust. Actions speak louder than treaties in dwarven culture. How you approach this will shape everything that follows."`;

const dwarvenChoice = `The choice weighs on you. Do you take time to demonstrate cultural respect through preparing feast that honors dwarven hospitality traditions? Or do you proceed with efficient formal negotiations, trusting in political logic and pragmatic exchange?`;

const getDwarvenFragmentQuestText = (): string => {
	return `${ironpeakJourney}

${finnLeading}

${ironpeakCity}

${dwarvenWelcome}

${dwarvenChoice}`;
};

export const DwarvenFragmentQuest: Scene = {
	id: 'dwarven_fragment_quest',
	get text() {
		return getDwarvenFragmentQuestText();
	},
	choices: [
		{
			id: 'prepare-feast',
			text: 'Prepare a diplomatic feast to honor dwarven hospitality customs - demonstrate cultural respect through shared meal preparation',
			next: 'diplomatic_feast_prep',
			effects: { wisdom: 4, charisma: 3 },
			hiddenEffects: {
				cultural_respect: true,
				seraphine_approves: true,
				finn_impressed: true
			}
		},
		{
			id: 'proceed-directly',
			text: 'Proceed directly to Ironpeak for formal negotiations - rely on political logic and pragmatic exchange',
			next: 'ironpeak_negotiation',
			effects: { courage: 3 },
			hiddenEffects: {
				direct_approach: true,
				finn_friendship: 15
			}
		}
	]
};

// Dragon Fragment Quest - Dragon's Spine Mountains

const dragonTerritory = `The Dragon's Spine Mountains earn their name from jagged peaks that rise like vertebrae along the northern border, volcanic stone still warm with geothermal heat that keeps these heights perpetually shrouded in steam and smoke. This is dragon territory - hostile to human life by nature and by design, a place where the air itself feels charged with predatory awareness, where every shadow might conceal scaled death, where simply surviving the approach is its own test of worthiness.`;

const volcanicLandscape = `Lava flows carve glowing rivers through black stone, their heat intense enough to blister skin from yards away. Geysers erupt without warning, sending superheated water and steam skyward in explosive columns. The ground trembles constantly with subterranean activity - not quite earthquakes, but reminders that this land is fundamentally unstable, alive with volcanic fury barely contained beneath fragile surface. Sulfur stings your nostrils. The roar of geological forces drowns out normal conversation.`;

const thorneDrakeAppearance = `Thorne Drake awaits at the summit of the highest peak, and the sight of him steals breath more effectively than thin mountain air. He's massive even for a dragon - scales the color of molten gold, wings that span wide enough to cast shadows over entire villages, eyes that burn with intelligence and ancient pride. Smoke curls from his nostrils with each breath. His mere presence radiates power that makes your blood mark react with mixture of recognition and warning.

This is apex predator, creature from age when dragons ruled through strength that brooked no challenge. Yet there's also unmistakable intelligence in those burning eyes - not just animal cunning, but philosophical depth, strategic thinking, wisdom accumulated over centuries of existence that makes human lifespans seem like mayfly ephemera.`;

const dragonGreeting = `"So," Thorne's voice rumbles like distant thunder, each word precisely articulated despite coming from throat designed for roaring rather than human speech, "the Silverwood heir comes seeking what my flight has guarded for twenty years. Lyra sent word of your approach, vouched for your character in ways she rarely does for humans. That earns you audience. But only audience."

His tail sweeps across stone with grinding sound. "Dragons do not recognize human political structures. We care nothing for your Loyalist factions or Reformist ideologies or Military power plays. We respect only strength and wisdom demonstrated directly, personally, irrefutably. You could command armies of thousands, possess political backing of every noble house, promise wealth beyond measure - and none of it would matter to us. What matters is this: who you are when stripped of all advantages, reduced to essential self, facing challenges designed to break lesser beings."`;

const trialExplanation = `Another dragon descends - smaller than Thorne but still terrifyingly large, scales the deep crimson of cooling lava. "Three trials await," this second dragon announces, voice carrying feminine quality that somehow makes it no less intimidating. "Combat - prove your strength and skill against opponents that won't hesitate, won't show mercy, won't stop until you surrender or triumph. Riddles - demonstrate wisdom deeper than surface cleverness, understanding that sees connections others miss. Character - reveal who you truly are when all pretense is burned away, when survival depends on authentic response rather than calculated performance."

Thorne adds with something approaching dark amusement, "Many have attempted our trials. Some died in combat, strength insufficient to survive what we required. Others failed the riddles, cleverness proving inadequate substitute for genuine wisdom. A few passed both but revealed character so flawed, so corrupted by ambition or cruelty or weakness, that we denied them regardless. We will not unleash powerful artifacts into hands unworthy to wield them, regardless of their bloodline or destiny or desperate need."

His burning gaze settles on you with weight like physical pressure. "Succeed in all three, and you'll earn not just the fragment but alliance with beings powerful enough to end kingdoms or defend them. Fail any trial, and you leave alive but empty-handed - we are not cruel, but we are uncompromising. Dragons do not award participation prizes or grade on curves. Excellence or nothing. That is our way."`;

const getDragonFragmentQuestText = (): string => {
	return `${dragonTerritory}

${volcanicLandscape}

${thorneDrakeAppearance}

${dragonGreeting}

${trialExplanation}

The challenge is clear: prove yourself through direct demonstration of who you are and what you're capable of, with no political backing or factional support to cushion failure. Just you, your skills, your wisdom, and your character - measured against standards that have broken countless would-be heroes before you.`;
};

export const DragonFragmentQuest: Scene = {
	id: 'dragon_fragment_quest',
	get text() {
		return getDragonFragmentQuestText();
	},
	choices: [
		{
			id: 'continue',
			text: 'Accept the dragon trials with courage and determination - face combat, riddles, and tests of character to prove your worth',
			next: 'companion_personal_quests',
			effects: { courage: 6, wisdom: 4 },
			hiddenEffects: {
				dragon_fragment_obtained: true,
				thorne_respect: 30
			}
		}
	]
};

// Palace Fragment Quest - Reclaiming Heritage

const returningHome = `The royal palace rises before you like monument to both glory and tragedy - your ancestral home, seat of Silverwood power for generations, the place where your family lived and laughed and ruled and ultimately died. Twenty years have passed since the Purge, twenty years of political contests and factional claims and careful avoidance of the question everyone knows must eventually be answered: who truly owns this place, this power, this legacy written in stone and blood?`;

const palaceCondition = `The palace shows its abandonment in ways both obvious and subtle. Grand architecture remains largely intact - stone walls that have stood for centuries won't fall to mere neglect, soaring towers that were built to endure through ages of monarchy. But gardens have become wild tangles. Windows that once gleamed are now dusty or broken. The courtyards where nobility once gathered for ceremony and celebration are empty except for weeds growing through ornamental stonework.

Yet there's also evidence of recent activity. Various factions have maintained presences here, staked informal claims, established de facto control over different sections. The Loyalists have secured the throne room, treating it as sacred space too important to abandon entirely. The Military has fortified strategic positions, positioning guards at key access points. Even the Reformists have representatives here, documenting historical records and ensuring no faction gains total dominance. The palace has become contested territory, a physical manifestation of the political tensions tearing at the realm.`;

const politicalComplications = `Marcus briefs you with military precision about the political minefield you're entering. "Every faction has staked claims here. The Loyalists argue the palace belongs to you by right of blood, that your return supersedes all other considerations. The Military controls physical access and sees strategic value in maintaining that control. The Reformists worry about what claiming the palace means symbolically - whether it represents commitment to constitutional monarchy or regression to absolute rule."

He spreads architectural diagrams showing the vault locations. "The core fragment is in the deepest vaults, sealed by your grandmother's own blood magic in the final hours before the Purge. Only Silverwood blood can break those seals. But reaching the vault requires passing through areas currently controlled by different factions, navigating political tensions that could erupt into violence if mishandled."

Seraphine adds her perspective, political acumen recognizing complexities that pure military thinking might miss. "The moment you attempt to retrieve this fragment, you make definitive statement about your intentions. Claiming the palace isn't just securing an artifact - it's asserting sovereignty, establishing yourself physically at the center of royal power, sending message to everyone about what kind of ruler you intend to be. That message will reverberate through every political calculation in the realm."`;

const emotionalWeight = `But beyond political complications lies deeper challenge - emotional weight of confronting your family's destruction directly. The vault where the fragment waits is also where your family made their last stand, where they chose to shatter the Crystal Heart rather than let it fall to coup forces, where they died defending principles and power and each other. Opening that vault means confronting not just magical seals but the concentrated grief of their final moments, the trauma sealed along with the fragment, the ghosts of tragedy that have haunted this place for twenty years.

Lyra warned you about this. "Your grandmother wove her dying magic into those seals. Blood magic powered by desperate love and furious determination and grief so profound it transcends mortal understanding. When you break those seals, you'll experience echoes of what she felt. Be prepared for that. The fragment will come with memories you may not want to receive."`;

const getPalaceFragmentQuestText = (): string => {
	return `${returningHome}

${palaceCondition}

${politicalComplications}

${emotionalWeight}

The choice to pursue the palace fragment first is bold - claiming your heritage directly, confronting your family's tragedy head-on, establishing yourself at the center of power regardless of political complications. But bold doesn't mean easy. This will test you in ways the other fragments won't - not through external trials set by others, but through internal confrontation with your own legacy, grief, and the weight of stepping into role that cost your family everything.`;
};

export const PalaceFragmentQuest: Scene = {
	id: 'palace_fragment_quest',
	get text() {
		return getPalaceFragmentQuestText();
	},
	choices: [
		{
			id: 'continue',
			text: 'Navigate the political complications and emotional weight - claim your heritage by confronting your family\'s tragedy directly',
			next: 'companion_personal_quests',
			effects: { wisdom: 5 },
			hiddenEffects: {
				palace_fragment_obtained: true,
				family_legacy_honored: true
			}
		}
	]
};
